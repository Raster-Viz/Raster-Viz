<!DOCTYPE html>
<html lang="en-US">
<head>
    {% if red_flag %}
    <div id="red_flag" title="Red Flag">
        <p>{{vocal}}</p>
    </div>
    {% endif %}

    {% load static %}
    <link rel="icon" href="{% static 'rs_viz/imgs/mountain_32.ico' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'rs_viz/css/styles.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'rs_viz/css/print.css' %}" media="print"/>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Raster Viz Web Utility</title>
</head>

<body>
{% if fnp %}
<script>window.alert('file(s) not found in Database')</script>
{% endif %}
<!-- Top Menu Bar-->
<nav id='menu' class="noprint">
    <ul>
        <li>
            <button class="dropdown-arrow firstBtn">File</button>
            <ul class='sub-menus'>
                <li><a href="{% url 'del' %}" id="new">New</a></li>
                <li><a href="{% url 'xml' %}" id="download" download="data_paths">Save</a></li>
                <li><a href="" id="print" onclick="changefunction(id);">Print</a></li>
                <li><a href="{% url 'html_export' %}" id="download" download="completed_rendering">Export</a></li>

                <li><a href="{% url 'layer_upload' %}" id="import">Import</a></li>
                <li>
                    <button id="btn_import">Import (Modal)</button>
                </li>
                <li>
                    <button id="btn_openENV">Open ENV</button>
                </li>
            </ul>
        </li>
        <li>
            <button class="dropdown-arrow menuBtn">Edit</button>
            <ul class='sub-menus'>
                <!--<li><a href="{% url 'rem' %}">Remove</a></li>-->
                <li>
                    <button id="btn_remove">Remove</button>
                </li>

                <li>
                    <button id="btn_properties">Properties</button>
                </li>
            </ul>
        </li>
        <li>
            <button class="dropdown-arrow">View</button>
            <ul class='sub-menus'>
                <li><a href="#">Zoom to Layer</a></li>
                <li><a href="#">Selection Zoom</a></li>
                <li><a href="#">Grid</a></li>
                <li><a href="#">Ruler</a></li>
            </ul>
        </li>
        <li><a href="{% url 'help' %}">Help</a></li>
        <li class="appName">Raster Viz Web Utility</li>
    </ul>
</nav>

<!-- Main Application -->
<div class="grid-container">

    <!-- Table of Contents Header / Toolbar -->
    <div class="toc noprint">TABLE OF CONTENTS</div>

    <div class="select noprint" id="toolbar">
        <button type="submit" form="render">Render Changes</button>
        <button type="button" onclick="toggle_visibility('FoliumMap', 'RasterImages')">Map</button>
        <button type="button" onclick="toggle_visibility('RasterImages', 'FoliumMap')">Image</button>
        <button type="button">&#9432;</button>
    </div>

    <!-- Layer View -->
    <div class="layer noprint" style="overflow: auto">
        <table>
            <tr class="tr_layer">
                <th class="th_col_width_layer">
                    <span class="full_act">Activate</span>
                    <span class="short">Act.</span>
                </th>
                <th class="th1">Layer Name</th>
            </tr>
            <form method="POST" id="render" action="{% url 'rend' %}"> {% csrf_token %}
                {% for layer in alayers %}
                {% if layer.activated %}
                <tr>
                    <td><input type="checkbox" name="choices" id="achoice{{ forloop.counter }}"
                               value="{{ layer.document }}" checked/></td>
                    <td><label for="choice{{ forloop.counter }}">{{ layer.filename }}</label><br/></td>
                </tr>
                {% else %}
                <tr>
                    <td><input type="checkbox" name="choices" id="ilchoice{{ forloop.counter }}"
                               value="{{ layer.document }}"/></td>
                    <td><label for="choice{{ forloop.counter }}">{{ layer.filename }}</label><br/></td>
                </tr>
                {% endif %}
                {% endfor %}
            </form>
        </table>
    </div>

    <!-- Map View -->
    <div class="map" id="FoliumMap">{{ folMap|safe }}</div>
    <div class="rast" id="RasterImages"><img src="data:image/png;base64,{{ graphic|safe }}"></div>

    <!-- Identify Cell -->
    <div class="id noprint" style="overflow: auto">
        <table>
            <tr class="tr_id">
                <!--<th style="width: 35%">Location</th>-->
                <th class="th_col_width_id">
                    <span class="full_loc">Location</span>
                    <span class="short">Loc.</span>
                </th>
                <th class="th1">Value(s)</th>
            </tr>
        </table>
    </div>

</div>

<!-- The Modal -->
<div id="mainModal" class="modal">

    <!-- Import  -->
    <div id="modal_import" class="modal-import">
        <div class="modal-header">
            <span class="close">&times;</span>
            <h3>Import New File</h3>
        </div>
        <div class="modal-body">
            {% block content %}
            <form action="{% url 'layer_upload' %}"  method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <tr>
                    <ul> Name <input type="text" id="name" name="name"></ul>
                    <ul>Document<input type="file" id="document" name="filename"></ul>
                    <ul>Activated <input type="checkbox" id="activated" name="activated" checked></ul>
                </tr>
                <input type="submit">
            </form>


{% endblock %}
        </div>
    </div>

    <!-- Open ENV  -->
    <div id="modal_openENV" class="modal-openENV">
        <div class="modal-header">
            <span class="close">&times;</span>
            <h3>Open Environment</h3>
        </div>
        <div class="modal-body">
            <p>Load XML File to database</p>
            <form action="{% url 'env' %}" method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <tr>
                    <input type="file" id="myFile" name="filename">
                </tr>
                <p>
                    <input type="submit">
                </p>
            </form>
        </div>
    </div>

    <!-- Remove Layer(s) -->
    <div id="modal_remove" class="modal-remove">
        <div class="modal-header">
            <span class="close">&times;</span>
            <h3>Remove Layer(s)</h3>
        </div>
        <div class="modal-body">
            <p>Load XML File to database</p>
            <form action="{% url 'rem' %}" method="POST" action="{% url 'set' %}"> {% csrf_token %}
                {% for layer in layers %}
                <tr>
                    <td><input type="checkbox" name="choice" id="choice{{ forloop.counter }}" value="{{ layer.filename }}" /></td> <!-- The code, 'layer.filename' is used for now to show distiction between duplicate layers. This adds random letters to the filename and should probably be changed to show an ordered numbering in parenthesis or similar. -->
                    <td><label for="choice{{ forloop.counter }}">{{ layer.filename }}</label><br /></td>
                    {% endfor %}
                </tr>
                <p><button type="submit">Remove</button></p>
            </form>
        </div>
    </div>

    <!-- Properties -->
    <div id="modal_properties" class="modal-properties">
        <div class="modal-header">
            <span class="close">&times;</span>
            <h3>Layer Properties</h3>
        </div>
        <div class="modal-body">
            <p>Test</p>
        </div>
    </div>

</div>

<script src="{% static 'rs_viz/script.js' %}"></script>
</body>
</html>
